<!DOCTYPE html>
<html lang="en"><head>
<link href="../../cup-hot" rel="icon">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Bruno Gondim Toledo">
  <meta name="author" content="Stefan Zurman Gonçalves">
  <meta name="author" content="João Pedro Almeida Santos">
  <meta name="author" content="João Alberto de Rezende Alvares">
  <title>Bruno Gondim – Técnica Random Forest em árvores de decisão</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-816793a8a4a837d14f6ea458e2f1c5cb.css">
  <link rel="stylesheet" href="styles.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Técnica Random Forest em árvores de decisão – Bruno Gondim">
<meta property="og:description" content="Grupo 4">
<meta property="og:site_name" content="Bruno Gondim">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Técnica Random Forest em árvores de decisão</h1>
  <p class="subtitle">Grupo 4</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://github.com/penasta">Bruno Gondim Toledo</a> 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Stefan Zurman Gonçalves 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
João Pedro Almeida Santos 
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
João Alberto de Rezende Alvares 
</div>
</div>
</div>

</section>
<section id="introdução" class="slide level2">
<h2>Introdução</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>O que é floresta aleatória?</p>
</div>
<p>Floresta aleatória é um algoritmo de <em>Machine learning</em>, utilizado para realizar predições, que combina o resultado de múltiplas árvores de decisão criadas aleatoriamente com o objetivo de diminuir a variância e o viés no contexto dos métodos de árvores.</p>
</section>
<section id="introdução-1" class="slide level2">
<h2>Introdução</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>Árvore de decisão</p>
</div>
<p>Uma árvore de decisão é a forma mais básica entre os métodos baseados em árvore, muito utilizada em regressão e classificação, uma árvore de decisão consiste em segmentar o espaço composto pelas variáveis preditoras em regiões mais simples, nos quais a média (se a variável resposta for quantitativa) é utilizada como valor predito ou (caso categorizado) a classe da variável resposta com maior frequência, os modelos de árvores de decisão são atraentes pela simplicidade e fácil interpretação, contudo não possuem a precisão que outros métodos de classificação ou regressão alcançam.</p>
</section>
<section id="vantagens-e-desvantagens" class="slide level2">
<h2>Vantagens e desvantagens</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>sobre árvore de decisão:</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p>Vantagens</p>
<ul>
<li class="fragment">São facilmente explicaveis;</li>
<li class="fragment">Podem ser representadas graficamente com fácil interpretação;</li>
<li class="fragment">Podem manupular preditores qualitativos sem a necessidade de variáveis <em>dummy</em>.</li>
</ul>
</div><div class="column" style="width:50%;">
<p>Desvantagens</p>
<ul>
<li class="fragment">Não possuem o mesmo nível de precisão preditiva como outros modelos de regressão e classificação;</li>
<li class="fragment">Não são robustas, ou seja, uma pequena mudança nos dados pode gerar uma grande mudança na árvore de estimação final.</li>
</ul>
</div></div>
</section>
<section id="motivação" class="slide level2">
<h2>Motivação</h2>
<p>Uma forma de superar a baixa precisão das árvores de decisão é a utilização de métodos agregadoes que ajustam modelos poderosos, como floresta aleatória, que consegue uma grande melhoria no poder de predição mesmo comparando com outros modelos de classificação.</p>
</section>
<section id="procedimento" class="slide level2">
<h2>Procedimento</h2>
<ul>
<li class="fragment">Como na técnica <em>bagging</em>, construímos várias árvores a partir das amostras <em>bootstrap</em> do conjunto de testes.</li>
<li class="fragment">Na construção de cada árvore, cada vez que uma divisão (ou corte) é considerada para alguma árvore, <strong>uma seleção aleatória dos preditores é escolhida</strong> como candidatos dos cortes ao invés de todos os preditores como normalmente é feito.</li>
<li class="fragment">Essa abordagem tem como propósito reduzir a correlação entre as árvores, reduzindo a variância quando tiramos a média das árvores, já que a média tende a ser menor quando temos menor correlação entre as árvores.</li>
<li class="fragment">A escolha do número de preditores que serão selecionados para cada corte, é tipicamente escolhida pela raiz quadrada do número total de preditores.</li>
<li class="fragment">Florestas aleatórias fornecem uma melhoria em relação ao método <em>bagging</em>, já que a correlação entre as árvores diminui.</li>
</ul>
</section>
<section id="considerações" class="slide level2">
<h2>Considerações</h2>
<ul>
<li><p>De forma geral, pode-se dizer que o procedimento introduz mais aleatoriedade e diversidade no processo de construção em relação ao método <em>bagging</em>.</p></li>
<li><p>Intuitivamente, a utilização de florestas aleatórias para tomada de decisão corresponde à síntese da opinião de indivíduos com diferentes fontes de informação.</p></li>
<li><p>Em geral, florestas aleatórias produzem resultados menos variáveis em relação ao método <em>bagging</em>, já que nesse método as árvores geradas podem ser muito semelhantes, dependendo de preditores fortes, o que não contribui para redução de variabilidade das predições, o que não acontece com florestas aleatórias.</p></li>
</ul>
</section>
<section id="rotina" class="slide level2">
<h2>Rotina</h2>
<p>Uma rotina minimalista de classificação via <em>Random Forest</em> em <strong>R</strong> pode ser executada da seguinte forma:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a>data <span class="ot">&lt;-</span> iris</span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a>data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Species)</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="fu">set.seed</span>(<span class="dv">150167636</span>)</span>
<span id="cb1-8"><a></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-9"><a></a>              <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>))</span>
<span id="cb1-10"><a></a>train <span class="ot">&lt;-</span> data[ind<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb1-11"><a></a>test <span class="ot">&lt;-</span> data[ind<span class="sc">==</span><span class="dv">2</span>,]</span>
<span id="cb1-12"><a></a></span>
<span id="cb1-13"><a></a>rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Species<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">proximity=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = Species ~ ., data = train, proximity = TRUE) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 2

        OOB estimate of  error rate: 6.36%
Confusion matrix:
           setosa versicolor virginica class.error
setosa         33          0         0  0.00000000
versicolor      0         36         3  0.07692308
virginica       0          4        34  0.10526316</code></pre>
</div>
</div>
</div></div>
</section>
<section id="resultados" class="slide level2">
<h2>Resultados</h2>
<p>Podemos acessar os resultados do modelo no objeto <em>rf</em></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Teste do modelo no conjunto de treino:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">library</span>(caret)</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a>p1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf, train)</span>
<span id="cb3-4"><a></a><span class="fu">confusionMatrix</span>(p1, train<span class="sc">$</span> Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         33          0         0
  versicolor      0         39         0
  virginica       0          0        38

Overall Statistics
                                    
               Accuracy : 1         
                 95% CI : (0.967, 1)
    No Information Rate : 0.3545    
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16 
                                    
                  Kappa : 1         
                                    
 Mcnemar's Test P-Value : NA        

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                    1.0            1.0000           1.0000
Specificity                    1.0            1.0000           1.0000
Pos Pred Value                 1.0            1.0000           1.0000
Neg Pred Value                 1.0            1.0000           1.0000
Prevalence                     0.3            0.3545           0.3455
Detection Rate                 0.3            0.3545           0.3455
Detection Prevalence           0.3            0.3545           0.3455
Balanced Accuracy              1.0            1.0000           1.0000</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Validação do modelo nos dados de teste:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>p2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf, test)</span>
<span id="cb5-2"><a></a><span class="fu">confusionMatrix</span>(p2, test<span class="sc">$</span> Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         17          0         0
  versicolor      0         10         2
  virginica       0          1        10

Overall Statistics
                                          
               Accuracy : 0.925           
                 95% CI : (0.7961, 0.9843)
    No Information Rate : 0.425           
    P-Value [Acc &gt; NIR] : 3.546e-11       
                                          
                  Kappa : 0.8854          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                  1.000            0.9091           0.8333
Specificity                  1.000            0.9310           0.9643
Pos Pred Value               1.000            0.8333           0.9091
Neg Pred Value               1.000            0.9643           0.9310
Prevalence                   0.425            0.2750           0.3000
Detection Rate               0.425            0.2500           0.2500
Detection Prevalence         0.425            0.3000           0.2750
Balanced Accuracy            1.000            0.9201           0.8988</code></pre>
</div>
</div>
</div></div>
</section>
<section id="parâmetros" class="slide level2">
<h2>Parâmetros</h2>
<ul>
<li><p>A função <em>randomForest</em> do pacote homônimo tem uma série de parâmetros opcionais além do mínimo obrigatório, que seria o modelo e os dados. O mais importante destes parâmetros é o <em>ntree</em>, que por <em>default</em> é 500 e em geral deve-se utilizar o máximo possível tal que execute em um tempo aceitável. Em geral, o restante dos parâmetros deve ser deixado em <em>default</em>.</p></li>
<li><p>Neste caso, o modelo foi extremamente eficiente mesmo na versão minimalista</p></li>
</ul>
</section>
<section id="fine-tuning" class="slide level2">
<h2>Fine tuning</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>Se for o caso, também podemos fazer o <em>fine-tuning</em> dos parâmetros do modelo</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>t <span class="ot">&lt;-</span> <span class="fu">tuneRF</span>(train[,<span class="sc">-</span><span class="dv">5</span>], train[,<span class="dv">5</span>],</span>
<span id="cb7-2"><a></a>       <span class="at">stepFactor =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-3"><a></a>       <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-4"><a></a>       <span class="at">ntreeTry =</span> <span class="dv">150</span>,</span>
<span id="cb7-5"><a></a>       <span class="at">trace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-6"><a></a>       <span class="at">improve =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mtry = 2  OOB error = 5.45% 
Searching left ...
mtry = 4    OOB error = 5.45% 
0 0.05 
Searching right ...
mtry = 1    OOB error = 5.45% 
0 0.05 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">hist</span>(<span class="fu">treesize</span>(rf),</span>
<span id="cb9-2"><a></a>     <span class="at">main =</span> <span class="st">"No. of Nodes for the Trees"</span>,</span>
<span id="cb9-3"><a></a>     <span class="at">col =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="importâncias" class="slide level2">
<h2>Importâncias</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>Podemos verificar a importância de cada variável para o modelo.</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">varImpPlot</span>(rf,</span>
<span id="cb10-2"><a></a>           <span class="at">sort =</span> T,</span>
<span id="cb10-3"><a></a>           <span class="at">n.var =</span> <span class="dv">10</span>,</span>
<span id="cb10-4"><a></a>           <span class="at">main =</span> <span class="st">"Top 10 - Variable Importance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">importance</span>(rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             MeanDecreaseGini
Sepal.Length         7.299621
Sepal.Width          2.006132
Petal.Length        35.799244
Petal.Width         27.318058</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="implementações" class="slide level2">
<h2>Implementações</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>Uma rotina de classificação via <em>Random forest</em> poderia ser executada de forma análoga em <em>python</em> da seguinte forma:</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="fu">library</span>(reticulate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-3"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb14-4"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb14-5"><a></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb14-6"><a></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb14-7"><a></a></span>
<span id="cb14-8"><a></a>iris <span class="op">=</span> datasets.load_iris()</span>
<span id="cb14-9"><a></a>dados <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>iris.data, columns<span class="op">=</span>iris.feature_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a>X <span class="op">=</span> dados</span>
<span id="cb15-2"><a></a>y <span class="op">=</span> iris.target</span>
<span id="cb15-3"><a></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>model <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb16-2"><a></a>model.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb17-2"><a></a>confusion_matrix(y_test, y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[16,  0,  0],
       [ 0, 12,  0],
       [ 0,  2, 15]], dtype=int64)</code></pre>
</div>
</div>
</div></div>
</section>
<section id="definições" class="slide level2">
<h2>Definições</h2>
<p>As árvores podem ser representadas como <span class="math inline">\(h_1(\boldsymbol x),\;  h_2(\boldsymbol x),\; . . . ,\; h_K( \boldsymbol x)\)</span> na forma</p>
<p><span class="math display">\[ \{ h \left( \boldsymbol x, \Theta_k \right), \; \; k = 1, \dots \}  \]</span></p>
<p>onde <span class="math inline">\(\Theta_k \; \text{i.i.d}\)</span> são vetores aleatórios representando a escolha de <span class="math inline">\(p\)</span> entre os <span class="math inline">\(m\)</span> atributos de <span class="math inline">\(\boldsymbol X\)</span>.</p>
<p>Normalmente, <span class="math inline">\(p \approx \sqrt m\)</span></p>
</section>
<section id="definições-1" class="slide level2">
<h2>Definições</h2>
<p><strong>1)</strong> A medida em que o número de árvores cresce, a média de acertos se estabiliza e a chance de cometer uma predição errada pode ser quantificada:</p>
<p><span class="math display">\[  P_{\boldsymbol X, Y} \left(   P_{\Theta}( h(\boldsymbol X, \Theta) = Y)   - P_{\Theta} (h(\boldsymbol X, \Theta)  \neq Y) &lt; 0\right) \]</span></p>
<ul>
<li><span class="math inline">\(P_{\Theta}( h(\boldsymbol X, \Theta) = Y)\)</span> representa a probabilidade de que uma árvore acerte a predição de Y</li>
</ul>
</section>
<section id="definições-2" class="slide level2">
<h2>Definições</h2>
<p><strong>2)</strong> A acurácia da random forest vai depender do “poder” de cada um dos classificadores individuais e da dependência entre eles.</p>
<p>Um limite superior para o erro de generalização é dado por</p>
<p><span class="math display">\[PE^* \le -\bar \rho(1 − s^2)/s^2 \]</span></p>
<p>onde:</p>
<ul>
<li><p><span class="math inline">\(\boldsymbol s = E_{\boldsymbol X, Y} mr({\boldsymbol X, Y} )\)</span> é o “poder” das árvores <span class="math inline">\(h(\boldsymbol x, \Theta)\)</span></p></li>
<li><p><span class="math inline">\(\bar \rho\)</span> pode ser entendido como a média entre as correlações das árvores.</p></li>
</ul>
</section>
<section id="exemplo-alzheimer" class="slide level2">
<h2>Exemplo Alzheimer</h2>
<p>O dataset DARWIN (https://archive.ics.uci.edu/dataset/732/darwin) contém dados sobre a escrita a mão de pessoas afetadas pelo Alzheimer e de um grupo de controle, totalizando 174 observações. São 450 variáveis e o objetivo é distinguir pessoas afetadas (P) de pessoas saudáveis (H).</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-2"><a></a></span>
<span id="cb19-3"><a></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(</span>
<span id="cb19-4"><a></a>  class <span class="sc">~</span> ., <span class="at">data =</span> train_data, </span>
<span id="cb19-5"><a></a>  <span class="at">ntree =</span> <span class="dv">500</span>, </span>
<span id="cb19-6"><a></a>  <span class="at">importance =</span> <span class="cn">TRUE</span></span>
<span id="cb19-7"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<pre><code>No. of variables tried at each split: 21
OOB estimate of  error rate: 13.57%

Confusion matrix:
   H  P class.error
H 58 10   0.1470588
P  9 63   0.1250000</code></pre>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   H  P class.error
H 58 10   0.1470588
P  8 64   0.1111111</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Test error:8.82%"</code></pre>
</div>
</div>
</div></div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>No gráfico abaixo é possível perceber como a escolha do número de variáveis em cada <em>split</em> faz diferença para o resultado final do modelo.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-21-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Ainda, podemos verficiar a acurácia do modelo pelo número de árvores:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-22-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="robustez-a-dados-contaminados" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<p>Uma das vantagens das florestas aleatórias é sua robustez a pontos atípicos, ou outliers. O exemplo a seguir demonstra a robustez desses modelos a contaminações, além de compará-los a outros métodos de classificação:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(randomForest)</span>
<span id="cb23-2"><a></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(caret,e1071,VGAM)</span>
<span id="cb23-3"><a></a></span>
<span id="cb23-4"><a></a>iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a></a>  <span class="fu">mutate</span>(<span class="at">cor =</span> <span class="fu">ifelse</span>(Species <span class="sc">==</span> <span class="st">"setosa"</span>,<span class="dv">1</span>,<span class="fu">ifelse</span>(Species <span class="sc">==</span> <span class="st">"versicolor"</span>,<span class="dv">2</span>,<span class="dv">3</span>)))</span>
<span id="cb23-6"><a></a></span>
<span id="cb23-7"><a></a><span class="fu">set.seed</span>(<span class="dv">150167636</span>)</span>
<span id="cb23-8"><a></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(iris), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-9"><a></a>              <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>))</span>
<span id="cb23-10"><a></a>train <span class="ot">&lt;-</span> iris[ind<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb23-11"><a></a>test <span class="ot">&lt;-</span> iris[ind<span class="sc">==</span><span class="dv">2</span>,]</span>
<span id="cb23-12"><a></a></span>
<span id="cb23-13"><a></a></span>
<span id="cb23-14"><a></a></span>
<span id="cb23-15"><a></a>i<span class="ot">=</span><span class="dv">4</span> <span class="co">#Número de pontos contaminados</span></span>
<span id="cb23-16"><a></a>dadosPoluidos1 <span class="ot">&lt;-</span> train[train<span class="sc">$</span>cor<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb23-17"><a></a>dadosPoluidos1 <span class="ot">&lt;-</span> dadosPoluidos1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dadosPoluidos1),i,<span class="at">replace =</span> F),]</span>
<span id="cb23-18"><a></a></span>
<span id="cb23-19"><a></a>dadosPoluidos2 <span class="ot">&lt;-</span> train[train<span class="sc">$</span>cor<span class="sc">==</span><span class="dv">3</span>,]</span>
<span id="cb23-20"><a></a>dadosPoluidos2 <span class="ot">&lt;-</span> dadosPoluidos2[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dadosPoluidos2),i,<span class="at">replace =</span> F),]</span>
<span id="cb23-21"><a></a></span>
<span id="cb23-22"><a></a>dadosPoluidos1<span class="sc">$</span>Petal.Length <span class="ot">&lt;-</span> dadosPoluidos1<span class="sc">$</span>Petal.Length <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb23-23"><a></a>dadosPoluidos1<span class="sc">$</span>Petal.Width <span class="ot">&lt;-</span> dadosPoluidos1<span class="sc">$</span>Petal.Width <span class="sc">+</span> <span class="fl">1.7</span></span>
<span id="cb23-24"><a></a></span>
<span id="cb23-25"><a></a>dadosPoluidos2<span class="sc">$</span>Petal.Length <span class="ot">&lt;-</span> dadosPoluidos2<span class="sc">$</span>Petal.Length <span class="sc">-</span> <span class="dv">4</span></span>
<span id="cb23-26"><a></a>dadosPoluidos2<span class="sc">$</span>Petal.Width <span class="ot">&lt;-</span> dadosPoluidos2<span class="sc">$</span>Petal.Width <span class="sc">-</span> <span class="fl">1.2</span></span>
<span id="cb23-27"><a></a></span>
<span id="cb23-28"><a></a>DadosExempOutTreino <span class="ot">&lt;-</span> <span class="fu">rbind</span>(train,dadosPoluidos1,dadosPoluidos2)</span>
<span id="cb23-29"><a></a><span class="co">#DadosExempOutTreino &lt;- DadosExempOutTreino[,-6]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="robustez-a-dados-contaminados-1" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-24-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-25-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="robustez-a-dados-contaminados-2" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Random Forest</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         17          0         0
  versicolor      0         10         2
  virginica       0          1        10

Overall Statistics
                                          
               Accuracy : 0.925           
                 95% CI : (0.7961, 0.9843)
    No Information Rate : 0.425           
    P-Value [Acc &gt; NIR] : 3.546e-11       
                                          
                  Kappa : 0.8854          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                  1.000            0.9091           0.8333
Specificity                  1.000            0.9310           0.9643
Pos Pred Value               1.000            0.8333           0.9091
Neg Pred Value               1.000            0.9643           0.9310
Prevalence                   0.425            0.2750           0.3000
Detection Rate               0.425            0.2500           0.2500
Detection Prevalence         0.425            0.3000           0.2750
Balanced Accuracy            1.000            0.9201           0.8988</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Regressão logística</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         17          0         0
  versicolor      0          6         1
  virginica       0          5        11

Overall Statistics
                                          
               Accuracy : 0.85            
                 95% CI : (0.7016, 0.9429)
    No Information Rate : 0.425           
    P-Value [Acc &gt; NIR] : 3.669e-08       
                                          
                  Kappa : 0.7697          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                  1.000            0.5455           0.9167
Specificity                  1.000            0.9655           0.8214
Pos Pred Value               1.000            0.8571           0.6875
Neg Pred Value               1.000            0.8485           0.9583
Prevalence                   0.425            0.2750           0.3000
Detection Rate               0.425            0.1500           0.2750
Detection Prevalence         0.425            0.1750           0.4000
Balanced Accuracy            1.000            0.7555           0.8690</code></pre>
</div>
</div>
</div></div>
</section>
<section id="robustez-a-dados-contaminados-3" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>SVM linear</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         17          0         0
  versicolor      0          9         1
  virginica       0          2        11

Overall Statistics
                                          
               Accuracy : 0.925           
                 95% CI : (0.7961, 0.9843)
    No Information Rate : 0.425           
    P-Value [Acc &gt; NIR] : 3.546e-11       
                                          
                  Kappa : 0.8852          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                  1.000            0.8182           0.9167
Specificity                  1.000            0.9655           0.9286
Pos Pred Value               1.000            0.9000           0.8462
Neg Pred Value               1.000            0.9333           0.9630
Prevalence                   0.425            0.2750           0.3000
Detection Rate               0.425            0.2250           0.2750
Detection Prevalence         0.425            0.2500           0.3250
Balanced Accuracy            1.000            0.8918           0.9226</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>SVM radial</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         17          0         0
  versicolor      0         10         1
  virginica       0          1        11

Overall Statistics
                                          
               Accuracy : 0.95            
                 95% CI : (0.8308, 0.9939)
    No Information Rate : 0.425           
    P-Value [Acc &gt; NIR] : 2.026e-12       
                                          
                  Kappa : 0.9235          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                  1.000            0.9091           0.9167
Specificity                  1.000            0.9655           0.9643
Pos Pred Value               1.000            0.9091           0.9167
Neg Pred Value               1.000            0.9655           0.9643
Prevalence                   0.425            0.2750           0.3000
Detection Rate               0.425            0.2500           0.2750
Detection Prevalence         0.425            0.2750           0.3000
Balanced Accuracy            1.000            0.9373           0.9405</code></pre>
</div>
</div>
</div></div>
</section>
<section id="robustez-a-dados-contaminados-4" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<p>Comparando robustez de modelos com observações contaminadas</p>
<p>Sem contaminações</p>

<img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="robustez-a-dados-contaminados-5" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>2 contaminações</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-33-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>4 contaminações</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-34-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="robustez-a-dados-contaminados-6" class="slide level2">
<h2>Robustez a Dados Contaminados</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>6 contaminações</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-35-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>8 contaminações</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="apresentacao_files/figure-revealjs/unnamed-chunk-36-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="vantagens-e-desvantagens-1" class="slide level2">
<h2>Vantagens e desvantagens</h2>
<div style="margin-top: 1em; font-size: 1em">
<p>sobre classificação por florestas aleatórias:</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p>Vantagens</p>
<ul>
<li class="fragment">Robusto contra overfitting;</li>
<li class="fragment">Trabalha bem com dados de alta dimesão;</li>
<li class="fragment">Consegue captar relações não-lineares nos dados;</li>
<li class="fragment">Fornece uma medida de importância;</li>
<li class="fragment">Robusto contra outliers e ruídos;</li>
<li class="fragment">Consegue lidar com dados faltantes.</li>
</ul>
</div><div class="column" style="width:50%;">
<p>Desvantagens</p>
<ul>
<li class="fragment">Dificil interpretação;</li>
<li class="fragment">Não adequado para dados escassos;</li>
<li class="fragment">Demora para fazer predições;</li>
<li class="fragment">Requer ajuste de hiper-parâmetros.</li>
</ul>
</div></div>
</section>
<section id="referências" class="title-slide slide level1 center">
<h1>Referências:</h1>
<ul>
<li><p>Trevor Hastie, Robert Tibshirani, Gareth M. James, Daniela Witten. An introduction to Statistical Learning. Springer, 2013.</p></li>
<li><p>Pedro A. Morettin, Julio M. Singer. Estatística e Ciência de Dados. USP, 2021.</p></li>
<li><p>Finnstats. Randon Forest in R. Acessado em junho de 2024. Link: https://www.r-bloggers.com/2021/04/random-forest-in-r/</p></li>
<li><p>Breiman, L. Random Forests. Machine Learning <strong>45</strong>, 5–32 (2001)</p></li>
</ul>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="as_vert_cor.jpg" class="slide-logo"></p>
<div class="footer footer-default">
<p>Departamento de estatística - UnB</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1500,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/penasta\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>